<!DOCTYPE html>
<html lang="en">
<head>
        <title>Isometric Game Engine</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="http://haapa.la/theme/css/main.css" type="text/css" />
   

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://haapa.la/css/ie.css"/>
                <script src="http://haapa.la/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://haapa.la/css/ie6.css"/><![endif]-->
        
    <script type= "text/javascript">
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.src = 'https:' == document.location.protocol ? 'https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js' : 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; 
        s[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" + 
            "    config: ['MMLorHTML.js']," + 
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS','output/NativeMML']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," + 
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    tex2jax: { " +
            "        inlineMath: [ ['$','$'] ], " +
            "        displayMath: [ ['$$','$$'] ]," +
            "        processEscapes: true }, " +
            "    'HTML-CSS': { " +
            "        styles: { '.MathJax .mo, .MathJax .mi': {color: 'black ! important'}} " +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(s);
    </script>

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://haapa.la">Haapa.la </a></h1>
                <nav><ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="http://haapa.la/pages/curriculum-vitae.html">CV</a></li>
                    <li><a href="http://haapa.la/pages/isometric-game-engine.html">Isometric Game Engine</a></li>
                    <li><a href="http://haapa.la/pages/ray-tracing.html">Ray Tracing</a></li>
                </ul></nav>
        </header><!-- /#banner -->
        
<section id="content" class="body">    
    <h1 class="entry-title">Isometric Game Engine</h1>
    <p>Even more Javascript. This time in the form of a game engine with quick-n-dirty physics simulation. The goal of this project was to study the new HTML5 &lt;canvas&gt; tag and its performance.</p>
<p><img alt="A screenshot from Plethora" src="http://haapa.la/images/plethora.jpg" /></p>
<p>I knew from the start that despite the power of Google’s V8 and other modern Javascript engines I would easily hit the limits of Javascript’s performance. No matter how strong your JS is you can never reach the efficiency of an equivalent piece of C/C++, although JITting gets you pretty close (see also: <a href="http://asmjs.org/">ASM.js</a>). In case of physics engine this makes picking the right algorithms even more important.</p>
<p>One of the most computationally expensive parts of physics simulation is collision detection. In this phase the engine tries to find pairs of moving bodies that have just bumped to each other. The algorithms are usually required to return exact point(s) and surface normals of contact, which makes them relatively costly.</p>
<p>We can fortunately minimize the amount of these calls by using a lighter algorithm on top of it to filter pairs of bodies known to be far away. Bullet physics engine calls it the Broadphase.</p>
<p>The problem can be summarized as follows: Given body at location X, return list of bodies not further than Y units away. For static, non-moving objects I chose the Bounding Interval Hierarchy data structure. It allows me to do fast O(log n) spatial lookups. Moving objects are scanned with a Sweep line (or Sweep&amp;Prune) algorithm that allows me to benefit from coherency between consecutive frames.</p>
<p>Graphics are a bit more interesting. Basically every object is represented as a rectangular cuboid and the system maintains a directed acyclic (unfortunately, in some rare cases cyclic) graph where each link represents drawing order. The graph is flattened to an array and finally used as the final rendering order for the objects.</p>
<p>The latest development version also includes a level editor, ability to register, log in and save levels.</p>
<p>You can try an older version here: <a href="http://haapa.la/plethora">http://haapa.la/plethora</a> and the latest (alpha) version here: <a href="http://haapa.la/devplethora">http://haapa.la/devplethora</a></p>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                        </ul>
                </div><!-- /.blogroll -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">

        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-9759259-5");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>